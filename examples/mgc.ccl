name mgc

for each atom i:
    X0[i] = E[i]
    S[i, i] = 1
done

for each bond b = [i, j]:
        a = bo[b]
        S[i, j] = S[i, j] - a
        S[j, i] = S[j, i] - a
        S[i, i] = S[i, i] + a
        S[j, j] = S[j, j] + a
done

X = inv(S) * X0

n = sum[k](1.0)
Xm = sum[k](X[k]) ^ (1 / n)

q = (X - X0) / Xm

where
bo is order
E is electronegativity
k is atom
